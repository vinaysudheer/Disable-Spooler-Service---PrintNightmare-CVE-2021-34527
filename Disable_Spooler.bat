@ECHO OFF
:menu
echo 1 - Check and disable Microsoft Spooler Service
echo 2 - Renable Microsoft Spooler Service
echo 3 - Exit
choice /n /c:123
if %errorlevel% == 1 goto disablespooler
if %errorlevel% == 2 goto enablespooler
if %errorlevel% == 3 goto exit
:disablespooler
powershell.exe Get-Service -Name spooler
powershell.exe Get-Service -Name spooler | >NUL findstr "Stopped"
if %errorlevel%==0 (echo =================   Service is already disabled  =================) else (echo =================  Stopping Service  ================= & powershell.exe Stop-Service -Name Spooler -Force & powershell.exe Set-Service -Name Spooler -StartupType Disabled & echo =================  Service Disabled  =================)
pause
goto menu
:enablespooler
powershell.exe Get-Service -Name spooler
powershell.exe Get-Service -Name spooler | >NUL findstr "Stopped"
if %errorlevel%==0 (echo =================  Starting Service  ================= & powershell.exe Set-Service -Name Spooler -StartupType Automatic & powershell.exe Start-Service -Name Spooler & echo =================  Enabled Service  =================) else (echo =================   Service is already Running  =================)
pause
goto menu
:exit
exit